<!--库存查询  - 详情页 - yuweI-->
<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/themes.css" rel="stylesheet" />
		<link rel="import" href="./details_view.html" id="card_view"/>
	</head>

	<body>
		
		<!--<header class="mui-bar mui-bar-nav theme_back">
		   	<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		   	<a class="mui-pull-left theme_back_font">返回</a>
		    <h1 class="mui-title">详情</h1>
		</header>-->
		<div class="mui-content detailRow">
				<form class="mui-input-group" id="detailContent" style="background:none;">
					<ul class="mui-table-view" style="margin-bottom:12px;">
						<li class="mui-table-view-cell mui-collapse">
							<a class="mui-navigate-right" href="#">产品信息</a>
							<div class="mui-collapse-content">
									
							</div>
						</li>
					</ul>
				
				</form>
		</div>
		
		<script src="../../js/mui.js"></script>
		<script src="../../js/template-web.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/utils.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/request.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			(function($) {
				
				$.plusReady(function(){
					
					var params, hisDrugCode = undefined, drugCode = undefined;
					var self = plus.webview.currentWebview();
				    params = self.params;//获得参数
					hisDrugCode = JSON.parse(params).hisdrugcode;
					drugCode = JSON.parse(params).drugcode;
					var baseUrl = '/a/StoreDetail/getRoomRepertoryDetail';
					var tableUrl = '/a/StoreDetail/getRoomRepertoryDetailList';
					var renderData = { };
					genDetailData(baseUrl,hisDrugCode)
					genTableData(tableUrl,drugCode);
					var utils = new Utils();
					utils.appendModule('#card_view');
					setTimeout(function(){
						var html = template('deitail_view', renderData);
						document.getElementById('detailContent').innerHTML = html;
					},2000)
//					var html = template('deitail_view', data);
//					console.log(html)
					
					
				/*
				  获取列表数据
				 * */
					function genDetailData(baseUrl,hisDrugCode){
						// 详情 数据
						mui.ajaxRequest(baseUrl,{
	                		type: 'POST',
	                		data: {
	                			hisDrugCode: hisDrugCode
	                		},
	                		showWaiting: true,
	                		success: function(data){
	                			if(data.code === 200){
	                				var list = [];
	                				list.push(data.data);
	                				renderData.list = list;
	                			}else{
	                				mui.alert(data.msg)
	                			}
	                		},
	                		error: function(xhr,type,errorThrown){
								alert(xhr.responseText)
	                		}
	            		});
					}
					
					function genTableData(tableUrl,drugCode){
						// 列表数据
	            		mui.ajaxRequest(tableUrl,{
	                		type: 'post',
	                		data: {
	                			drugCode: drugCode
	                		},
	                		showWaiting: true,
	                		success: function(data){
	                			if(data.code === 200){
	                				var tablist = data.data.list;
	                				renderData.tablist = tablist;
	                				console.log(JSON.stringify(renderData))
	                			}else{
	                				mui.alert(data.msg)
	                			}
	                		},
	                		error: function(xhr,type,errorThrown){
								alert(xhr.responseText)
	                		}
	            		});
					}
					/*
					 展示数据
					 * */
					function showData(data){
						var acceptanceTab1 = document.querySelector('.mui-tab1');
						var html1 = template('list_tpl_view',data.unVerfiyList);
						if(!html1){
							html1 = nullDataHtml;
						}
						acceptanceTab1.innerHTML = html1;
					}
				})
			
		})(mui);
		
		</script>
	</body>

</html>